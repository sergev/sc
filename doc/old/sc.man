.tr @"
.TH ШЭТ 1
.SH ИМЯ
ШЭТ \- широкоформатная электронная таблица
.SH ФОРМАТ
.B sc
\fI[-] [-a] [-b] [-m] [-l] [-r#] [-c#] [файл]\fP
.SH ОПИСАНИЕ
В основе табличного процессора
.B ШЭТ
лежит "электронная таблица", разделенная на столбцы, строки и клетки.
Каждая клетка может содержать текстовую строку, число или формулу,
использующую в качестве операндов значения других клеток.
По умолчанию размер таблицы равен 64\ строкам по вертикали и
16\ столбцам по горизонтали. Его можно задавать флагами:
.IP -r<число>
определяет размер таблицы по вертикали в строках. Аргумент <число>
должен находиться в диапазоне от 1 до 32768.
.IP -с<число>
определяет размер таблицы по горизонтали в столбцах. Аргумент -
в диапазоне от 1 до 702.
.PP
При вызове
.B ШЭТ
загружает таблицу из файла с именем, указанным в качестве
аргумента, а если аргумент не задан - то из файла "workfile".
К имени автоматически добавляется суффикс ".sc".
.PP
Можно задавать следующие флаги:
.IP -
не считывать файл "workfile.sc"
.IP -a
выключить режим автоматического перевычисления
.IP -b
выключить отображение границ окна, подсказки и строки состояния
.IP -m
для цветных терминалов - не использовать цвета, работать в черно-белом режиме
.IP -l
переключить режим команд и диагностических сообщений.
В ШЭТ есть три режима:
1-й - английские сообщения, английские команды,
2-й - русские сообщения, английские команды,
3-й - русские сообщения, русские команды.
Режим по умолчанию зависит от глобальной переменной MSG: если MSG=r,
то устанавливается 2-й режим, иначе - 1-й.
.PP
Строки пронумерованы целыми числами, начиная с 0, а столбцы - латинскими
буквами A-Z, AA-ZZ. Для ссылки на клетку нужно указать номер
столбца и строки, в которой она находится, например, A0, BF54.
.PP
Если при вычислении формулы была ошибка (например, деление на 0),
то результат вычисления выдается в виде "??".
.PP
По таблице можно передвигаться, используя стрелки и команды
управления курсором. Текущая клетка выделяется инверсией или
квадратными скобками.
.PP
Для перемещения по таблице служат команды:
.IP "^L или стрелка влево"
влево на одну клетку
.IP "^R или стрелка вправо"
вправо на одну клетку
.IP "^U или стрелка вверх"
вверх на одну клетку
.IP "^D или стрелка вниз"
вниз на одну клетку
.IP "^Y или <Home>"
влево на ширину окна
.IP "^Z или <End>"
вправо на ширину окна
.IP "^K или <Page Up>"
вверх на высоту окна
.IP "^B или <Page Down>"
вниз на высоту окна
.PP
Для введения в таблицу новых формул, а также для редактирования значений
служит командный режим. Переход в него и обратно
осуществляется нажатием клавиши ^I (Tab).
.PP
В режиме ввода можно извлекать содержимое ячеек с помощью следующих команд:
.IP "^V"
ввести числовое значение текущей ячейки
.IP "^F"
ввести формулу из текущей ячейки
.IP "^T"
ввести текст из текущей ячейки
.IP "^A"
ввести имя текущей ячейки
.PP
Из режима ввода можно перейти в режим редактирования командой "^E".
В режиме редактирования выполняются следующие команды:
.IP "^M или <Return>"
выйти из режима редактирования
.IP "^L или стрелка влево"
влево на один символ
.IP "^R или стрелка вправо"
вправо на один символ
.IP "^D или стрелка вниз"
удалить текущий символ
.IP "^U или стрелка вверх"
вставить удаленный символ
.IP "^I или <Tab>"
перейти в конец или в начало строки
.PP
Если вводимое значение является синтаксически правильным выражением,
оно считается формулой, иначе - текстовым значением.
Для того, чтобы ввести текст явно, перед ним нужно поставить префикс '"'.
С помощью префиксов можно также управлять выравниванием:
.IP @
ввести текст
.IP <
ввести текст с выравниванием влево
.IP >
ввести текст с выравниванием вправо
.IP ^
ввести текст с центрированием
.IP =
ввести формулу
.IP =<
ввести формулу с выравниванием влево
.IP =>
ввести формулу с выравниванием вправо
.IP =^
ввести формулу с центрированием
.PP
Сервисные команды:
.IP "^X"
обновить экран
.IP "^С"
отказаться от выполнения текущей команды
.IP "^P"
выдать краткую инструкцию по работе в
.B ШЭТ
.IP "^G"
нарисовать график
.PP
В верхней строке выдается различная информация о текущем состоянии
.B ШЭТ:
.IP "@size@ или @размер@"
максимальный размер таблицы (его можно менять флагами -r, -c
или командами /Utility/Width, /Utility/Height)
.IP "@last@ или @конец@"
размер занятой части таблицы
.IP "@marked@ или @метка@"
координаты помеченной ячейки
.IP "@memory used@ или @занято@"
размер памяти, занятой данными (в байтах)
.IP "@free@ или @свободно@"
размер свободной памяти (в байтах)
.IP "@autocalc@ или @авто@"
признак режима автоматического перевычисления
.PP
В четвертой строке снизу находится информация о текущей ячейке:
имя ячейки, ширина и точность (в скобках), тип ячейки
(empty/пусто, text/текст, value/число, formula/формула),
тип выравнивания ("<"\ -\ прижать влево, ">"\ -\ прижать вправо,
"^"\ -\ центрировать), и собственно значение.
.PP
Командный режим построен на основе меню.
Текущее меню высвечивается на второй строке снизу.
Чтобы выбрать нужную команду, надо нажать клавишу, которая
выделена в имени команды большой буквой. Если после имени
команды в меню стоит символ "/", значит это - переход на следующий уровень
меню. Для передвижения по меню служа также команды:
.IP "^M или <Return>"
вернуться на предыдущий уровень меню
.IP "/"
вернуться на верхний уровень меню
.PP
Каждая команда однозначно определяется так называемым полным именем
команды. Оно состоит из собственно имени команды
и имен всех меню, ведущих к ней, разделенных символом "/",
например, "/Jump/Up". Для того, чтобы выполнить эту команду,
нужно ввести строку "/JU".
.PP
Перед некоторыми командами можно задавать целочисленный параметр,
определяющий, сколько раз нужно повторить данную команду.
.PP
При удалении строк или столбцов из таблицы все ссылки на удаляемые
клетки оказываются "висячими" и выглядят в формуле как "??".
.PP
При вычислении формул с висячими ссылками
или ссылками на клетки с ошибками вычисления также возникает ошибка.
.PP
Система команд:
.IP /Area/
переход в меню работы с областями (областью считается прямоугольный
участок таблицы от помеченной клетки до текущей)
.IP /Area/Copy
копирование области
.IP /Area/Delete
удаление области
.IP /Area/Format/
переход в меню установки формата
.IP /Area/Format/Center
центрирование клеток в области
.IP /Area/Format/Default
установка формата по умолчанию
.IP /Area/Format/Leftalign
установка прижима влево
.IP /Area/Format/Mark
установка метки на текущую клетку
.IP /Area/Format/Precision
задание точности для клеток в области
.IP /Area/Format/Rightalign
установка прижима вправо
.IP /Area/Mark
установка метки на текущую клетку
.IP /Area/Undelete
восстановление удаленной области
.IP /Area/Valuize
удаление формул из клеток в области (остаются только значения)
.IP /Area/fIll
заполнение области константами с заданными начальным значением и шагом
.IP /Cell/
переход в меню работы с отдельными ячейками
.IP /Cell/Copy
копирование помеченной ячейки в текущую
.IP /Cell/Delete
удаление содержимого текущей клетки
.IP /Cell/Format/
переход в меню установки формата
.IP /Cell/Format/Center
центрирование
.IP /Cell/Format/Default
установка формата по умолчанию
.IP /Cell/Format/Leftalign
установка прижима влево
.IP /Cell/Format/Mark
установка метки на текущую клетку
.IP /Cell/Format/Precision
задание точности
.IP /Cell/Format/Rightalign
установка прижима вправо
.IP /Cell/Mark
установка метки на текущую клетку
.IP /Cell/Undelete
восстановление удаленной клетки
.IP /File/
переход в меню работы с файлами
.IP /File/Load
загрузка таблицы из файла
.IP /File/Merge
слияние текущей таблицы и таблицы из файла
.IP /File/Print
печать таблицы в файл
.IP /File/Save
запись таблицы в файл
.IP /File/Tbl
запись таблицы в файл в формате
.B tbl
.IP /File/plOt
запись графика в файл в формате
.B plot
.IP /Graph/
переход в меню установки данных для графика
.IP /Graph/Hardcopy
печать графика на принтере
.IP /Graph/Mark
установка метки на текущую клетку
.IP /Graph/Reset
сброс установленных данных
.IP /Graph/Shape/
переход в меню установки типа графика
.IP /Graph/Shape/Bar
установка типа графика - столбчатая гистограмма
.IP /Graph/Shape/Graph
установка типа графика - линейный график
.IP /Graph/Shape/Pie
установка типа графика - круговая диаграмма
.IP /Graph/Shape/Stackedbar
установка типа графика - совмещенная гистограмма
.IP /Graph/Shape/X-y
установка типа графика - линейный график с нелинейной осью аргумента
.IP /Graph/axisA
установка данных для оси аргумента (область от помеченной клетки до текущей)
.IP /Graph/axisB
установка данных 1-й функции
.IP /Graph/axisC
установка данных 2-й функции
.IP /Graph/axisD
установка данных 3-й функции
.IP /Jump/
переход в меню передвижения по таблице
.IP /Jump/Cell
перейти на ячейку по имени
.IP /Jump/Down
перейти к последней клетке в текущем столбце
.IP /Jump/End
перейти к последней клетке таблицы
.IP /Jump/Left
перейти к первой ячейке в текущей строке
.IP /Jump/Right
перейти к последней ячейке в текущей строке
.IP /Jump/Up
перейти к первой ячейке в текущем столбце
.IP /Quit
выход из
.B ШЭТ
.IP /Row/
переход в меню работы со строками
.IP /Row/Copy
дублирование текущей строки
.IP /Row/Delete
удаление текущей строки
.IP /Row/Format/
переход в меню установки формата
.IP /Row/Format/Center
центрирование клеток в строке
.IP /Row/Format/Default
установка формата по умолчанию
.IP /Row/Format/Leftalign
установка прижима влево
.IP /Row/Format/Mark
установка метки на текущую клетку
.IP /Row/Format/Precision
задание точности для клеток в строке
.IP /Row/Format/Rightalign
установка прижима вправо
.IP /Row/Hide
спрятать текущую строку
.IP /Row/Insert
вставка пустой строки
.IP /Row/Show
открыть спрятанные строки
.IP /Row/Undelete
вернуть удаленную строку
.IP /Row/Valuize
заменить формулы в текущей строке значениями
.IP /Utility/
переход в меню сервисных команд
.IP /Utility/Width
установка количества столбцов в таблице
.IP /Utility/Height
установка количества строк в таблице
.IP /Utility/Minimize
уменьшение таблицы до минимально возможных размеров
.IP /Utility/Recalc
перевычисление таблицы
.IP /Utility/Autocalc
установка/снятие режима автоматического перевычисления
.IP /Utility/Border
установка/снятие режима отрисовки границы окна таблицы
.IP /Utility/Language
переключение языка команд/сообщений
.IP /Utility/Precision
установка точности по умолчанию
.IP /cOlumn/
переход в меню работы со строками
.IP /cOlumn/Copy
дублирование текущего столбца
.IP /cOlumn/Delete
удаление текущего столбца
.IP /cOlumn/Format/
переход в меню установки формата
.IP /cOlumn/Format/Center
центрирование клеток в столбце
.IP /cOlumn/Format/Default
установка формата по умолчанию
.IP /cOlumn/Format/Leftalign
установка прижима влево
.IP /cOlumn/Format/Mark
установка метки на текущую клетку
.IP /cOlumn/Format/Precision
задание точности для клеток в столбце
.IP /cOlumn/Format/Rightalign
установка прижима вправо
.IP /cOlumn/Hide
спрятать текущий столбец
.IP /cOlumn/Insert
вставка пустого столбца
.IP /cOlumn/Show
открыть спрятанные столбцы
.IP /cOlumn/Undelete
вернуть удаленный столбец
.IP /cOlumn/Valuize
заменить формулы в текущем столбце значениями
.IP /cOlumn/Width
установка ширины текущего столбца
.PP
Синтаксис формульных выражений близок к математической записи.
Приоритет операций следующий (от высшего к низшему):
^; *,/; +,-; <,=,>,<=,>=; &; |; ?.
.IP "e + e" 1i
Сложение.
.IP "e - e" 1i
Вычитание.
.IP "e * e" 1i
Умножение.
.IP "e / e" 1i
Деление.
.IP "e ^ e" 1i
Возведение в степень.
.IP "-e" 1i
Унарный минус.
.IP "e'" 1i
Возведение в квадрат.
.IP "~e" 1i
Квадратный корень.
.IP "v ++ v" 1i
Сумма всех непустых клеток в области с указанными углами.
.IP "v -- v" 1i
Среднее всех непустых клеток в области с указанными углами.
.IP "v ** v" 1i
Произведение всех непустых клеток в области с указанными углами.
.IP "v // v" 1i
Количество непустых клеток в области.
.IP "e ? e : e" 1i
Условная операция: если первое выражение - не 0, то значением операции
является значение второго выражения, иначе - значение третьего выражения.
.IP "<, =, >, <=, >=" 1i
Условные операции: 1 если выражение истинно, иначе 0.
.IP "&, |" 1i
Логические связки.
.IP "!e" 1i
Операция логического отрицания.
.IP "$v" 1i
защита ссылки от коррекции при перемещении выражения.
.PP
Разнообразные математические функции.
Большей частью это стандартные библиотечные функции,
более полно описанные в
.I math(3).
Все они оперируют с плавающими числами двойной точности,
тригонометрические функции работают с углами,
выраженными в радианах.
.IP "exp (expr)" 1i
Возвращает значение e в степени expr.
.IP "ln (expr)" 1i
Возвращает натуральный логарифм expr.
.IP "log (expr)" 1i
Возвращает десятичный логарифм expr.
.IP "pow (expr1, expr2)" 1i
Возвращает expr1 в степени expr2.
.IP "floor (expr)" 1i
Возвращает максимальное целое, не превосходящее expr.
.IP "ceil (expr)" 1i
Возвращает минимальное целое, не меньшее expr.
.IP "hypot (x, y)" 1i
Возвращает ~( x' + y' ), предпринимая меры против переполнения.
.IP "fabs (expr)" 1i
Возвращает абсолютное значение |expr|.
.IP "sin (expr), cos (expr), tan (expr)" 1i
Возвращает тригонометрическую функцию аргумента.
.IP "asin (expr)" 1i
Возвращает arcsin в диапазоне -pi/2...pi/2.
.IP "acos (expr)" 1i
Возвращает arccos в диапазоне 0...pi.
.IP "atan (expr)" 1i
Возвращает arctg в диапазоне -pi/2...pi/2.
.IP "dtr (expr)" 1i
Преобразует expr из градусов в радианы.
.IP "rtd (expr)" 1i
Преобразует expr из радианов в градусы.
.IP "pi" 1i
Примерно 3.1415926535...
.IP "e" 1i
Примерно 2.718281828459...
.IP "max (expr1, expr2)" 1i
Возвращает наибольшее из двух значений.
Допускается произвольное количество параметров.
.IP "min (expr1, expr2)" 1i
Возвращает наименьшее из двух значений.
Допускается произвольное количество параметров.
.IP "gamma (expr1)" 1i
Возвращает натуральный логарифм гамма-функции.
.PP
Работой ШЭТ можно управлять с помощью глобальных переменных:
.IP TERM 1i
имя терминала, служащее ключом поиска в базе данных
.B termcap
.IP TERMCAP 1i
альтернативное имя базы данных
.B termcap
или строка описания терминала
.IP MSG 1i
язык сообщений: r\ -\ русский, иначе - английский
.PP
При работе в ОС, совместимых с UNIX,
.B ШЭТ
использует характеристики терминала из
.B termcap. Обязательными являются следующие:
.IP "li"
количество строк на экране терминала (не\ меньше\ 7)
.IP "co"
количество символов в строке (не меньше 31)
.IP "cm"
позиционирование курсора
.PP
Необязательные характеристики:
.IP "is, fs"
инициализация, деинициализация терминала
.IP "if"
файл инициализации
.IP "ti, te"
включение, выключение возможности позиционирования курсора
.IP "vs, ve"
включение, выключение возможности выделения текста
.IP "so, se"
включение, выключение выделения текста (инверсия)
.IP "md, mh, me"
включение повышенного, пониженного, нормального уровня яркости
.IP "ms"
разрешение перемещения курсора в режиме выделения
.IP "cl"
стирание экрана и установка курсора в левый верхний угол
.IP "al, dl"
вставка, удаление строки
.IP "kl, kr, ku, kd"
коды клавиш управления курсором "влево", "вправо", "вверх", "вниз"
соответственно
.IP "kh, kN, kP"
коды клавиш "начало экрана", "следующая страница", "предыдущая страница"
.IP "C1, C2, Nf, Nb, Mf, Mb, Cf, Cb"
параметры управления цветом (см. termcap(5) ДЕМОС 2.1)
.SH ФАЙЛЫ
.IP "*.sc" 2i
файлы с таблицами
.IP "workfile.sc" 2i
файл с таблицей по умолчанию
.IP "/etc/termcap" 2i
файл с описаниями терминалов (кроме MSDOS)
.IP "/usr/lib/sc.????" 2i
файлы, со справочной информацией и сообщениями
(только для PC\ XT/VENIX, Электроника\-85/ДЕМОС,
СМ\-4/ДЕМОС)
.SH ССЫЛКИ
bc(1), dc(1), termcap(5)
