


ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



ИИММЯЯ
     ШЭТ - широкоформатная электронная таблица

ФФООРРММААТТ
     sscc [-] [-_a] [-_b] [-_m] [-_l] [-_r#] [-_c#] [_ф_а_й_л]

ООППИИССААННИИЕЕ
     В основе табличного процессора ШШЭЭТТ лежит "электронная таб-
     лица", разделенная на столбцы, строки и клетки.  Каждая
     клетка может содержать текстовую строку, число или формулу,
     использующую в качестве операндов значения других клеток.
     По умолчанию размер таблицы равен 64 строкам по вертикали и
     16 столбцам по горизонтали. Его можно задавать флагами:

     -r<число>
          определяет размер таблицы по вертикали в строках. Аргу-
          мент <число> должен находиться в диапазоне от 1 до
          32768.

     -с<число>
          определяет размер таблицы по горизонтали в столбцах.
          Аргумент - в диапазоне от 1 до 702.

     При вызове ШШЭЭТТ загружает таблицу из файла с именем, указан-
     ным в качестве аргумента, а если аргумент не задан - то из
     файла "workfile".  К имени автоматически добавляется суффикс
     ".sc".

     Можно задавать следующие флаги:

     -    не считывать файл "workfile.sc"

     -a   выключить режим автоматического перевычисления

     -b   выключить отображение границ окна, подсказки и строки
          состояния

     -m   для цветных терминалов - не использовать цвета, рабо-
          тать в черно-белом режиме

     -l   переключить режим команд и диагностических сообщений.
          В ШЭТ есть три режима: 1-й - английские сообщения, анг-
          лийские команды, 2-й - русские сообщения, английские
          команды, 3-й - русские сообщения, русские команды.
          Режим по умолчанию зависит от глобальной переменной
          MSG: если MSG=r, то устанавливается 2-й режим, иначе -
          1-й.

     Строки пронумерованы целыми числами, начиная с 0, а столбцы
     - латинскими буквами A-Z, AA-ZZ. Для ссылки на клетку нужно
     указать номер столбца и строки, в которой она находится,
     например, A0, BF54.



Printed 3/4/91                                                  1






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     Если при вычислении формулы была ошибка (например, деление
     на 0), то результат вычисления выдается в виде "??".

     По таблице можно передвигаться, используя стрелки и команды
     управления курсором. Текущая клетка выделяется инверсией или
     квадратными скобками.

     Для перемещения по таблице служат команды:

     ^L или стрелка влево
          влево на одну клетку

     ^R или стрелка вправо
          вправо на одну клетку

     ^U или стрелка вверх
          вверх на одну клетку

     ^D или стрелка вниз
          вниз на одну клетку

     ^Y или <Home>
          влево на ширину окна

     ^Z или <End>
          вправо на ширину окна

     ^K или <Page Up>
          вверх на высоту окна

     ^B или <Page Down>
          вниз на высоту окна

     Для введения в таблицу новых формул, а также для редактиро-
     вания значений служит командный режим. Переход в него и
     обратно осуществляется нажатием клавиши ^I (Tab).

     В режиме ввода можно извлекать содержимое ячеек с помощью
     следующих команд:

     ^V   ввести числовое значение текущей ячейки

     ^F   ввести формулу из текущей ячейки

     ^T   ввести текст из текущей ячейки

     ^A   ввести имя текущей ячейки

     Из режима ввода можно перейти в режим редактирования коман-
     дой "^E".  В режиме редактирования выполняются следующие
     команды:




Printed 3/4/91                                                  2






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     ^M или <Return>
          выйти из режима редактирования

     ^L или стрелка влево
          влево на один символ

     ^R или стрелка вправо
          вправо на один символ

     ^D или стрелка вниз
          удалить текущий символ

     ^U или стрелка вверх
          вставить удаленный символ

     ^I или <Tab>
          перейти в конец или в начало строки

     Если вводимое значение является синтаксически правильным
     выражением, оно считается формулой, иначе - текстовым значе-
     нием.  Для того, чтобы ввести текст явно, перед ним нужно
     поставить префикс '"'.  С помощью префиксов можно также
     управлять выравниванием:

     "    ввести текст

     <    ввести текст с выравниванием влево

     >    ввести текст с выравниванием вправо

     ^    ввести текст с центрированием

     =    ввести формулу

     =<   ввести формулу с выравниванием влево

     =>   ввести формулу с выравниванием вправо

     =^   ввести формулу с центрированием

     Сервисные команды:

     ^X   обновить экран

     ^С   отказаться от выполнения текущей команды

     ^P   выдать краткую инструкцию по работе в ШШЭЭТТ

     ^G   нарисовать график

     В верхней строке выдается различная информация о текущем
     состоянии ШШЭЭТТ::



Printed 3/4/91                                                  3






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     "size" или "размер"
          максимальный размер таблицы (его можно менять флагами
          -r, -c или командами /Utility/Width, /Utility/Height)

     "last" или "конец"
          размер занятой части таблицы

     "marked" или "метка"
          координаты помеченной ячейки

     "memory used" или "занято"
          размер памяти, занятой данными (в байтах)

     "free" или "свободно"
          размер свободной памяти (в байтах)

     "autocalc" или "авто"
          признак режима автоматического перевычисления

     В четвертой строке снизу находится информация о текущей
     ячейке: имя ячейки, ширина и точность (в скобках), тип
     ячейки (empty/пусто, text/текст, value/число,
     formula/формула), тип выравнивания ("<" - прижать влево,
     ">" - прижать вправо, "^" - центрировать), и собственно зна-
     чение.

     Командный режим построен на основе меню.  Текущее меню выс-
     вечивается на второй строке снизу.  Чтобы выбрать нужную
     команду, надо нажать клавишу, которая выделена в имени
     команды большой буквой. Если после имени команды в меню
     стоит символ "/", значит это - переход на следующий уровень
     меню. Для передвижения по меню служа также команды:

     ^M или <Return>
          вернуться на предыдущий уровень меню

     /    вернуться на верхний уровень меню

     Каждая команда однозначно определяется так называемым полным
     именем команды. Оно состоит из собственно имени команды и
     имен всех меню, ведущих к ней, разделенных символом "/",
     например, "/Jump/Up". Для того, чтобы выполнить эту команду,
     нужно ввести строку "/JU".

     Перед некоторыми командами можно задавать целочисленный
     параметр, определяющий, сколько раз нужно повторить данную
     команду.

     При удалении строк или столбцов из таблицы все ссылки на
     удаляемые клетки оказываются "висячими" и выглядят в формуле
     как "??".




Printed 3/4/91                                                  4






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     При вычислении формул с висячими ссылками или ссылками на
     клетки с ошибками вычисления также возникает ошибка.

     Система команд:

     /Area/
          переход в меню работы с областями (областью считается
          прямоугольный участок таблицы от помеченной клетки до
          текущей)

     /Area/Copy
          копирование области

     /Area/Delete
          удаление области

     /Area/Format/
          переход в меню установки формата

     /Area/Format/Center
          центрирование клеток в области

     /Area/Format/Default
          установка формата по умолчанию

     /Area/Format/Leftalign
          установка прижима влево

     /Area/Format/Mark
          установка метки на текущую клетку

     /Area/Format/Precision
          задание точности для клеток в области

     /Area/Format/Rightalign
          установка прижима вправо

     /Area/Mark
          установка метки на текущую клетку

     /Area/Undelete
          восстановление удаленной области

     /Area/Valuize
          удаление формул из клеток в области (остаются только
          значения)

     /Area/fIll
          заполнение области константами с заданными начальным
          значением и шагом

     /Cell/



Printed 3/4/91                                                  5






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



          переход в меню работы с отдельными ячейками

     /Cell/Copy
          копирование помеченной ячейки в текущую

     /Cell/Delete
          удаление содержимого текущей клетки

     /Cell/Format/
          переход в меню установки формата

     /Cell/Format/Center
          центрирование

     /Cell/Format/Default
          установка формата по умолчанию

     /Cell/Format/Leftalign
          установка прижима влево

     /Cell/Format/Mark
          установка метки на текущую клетку

     /Cell/Format/Precision
          задание точности

     /Cell/Format/Rightalign
          установка прижима вправо

     /Cell/Mark
          установка метки на текущую клетку

     /Cell/Undelete
          восстановление удаленной клетки

     /File/
          переход в меню работы с файлами

     /File/Load
          загрузка таблицы из файла

     /File/Merge
          слияние текущей таблицы и таблицы из файла

     /File/Print
          печать таблицы в файл

     /File/Save
          запись таблицы в файл

     /File/Tbl
          запись таблицы в файл в формате ttbbll



Printed 3/4/91                                                  6






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     /File/plOt
          запись графика в файл в формате pplloott

     /Graph/
          переход в меню установки данных для графика

     /Graph/Hardcopy
          печать графика на принтере

     /Graph/Mark
          установка метки на текущую клетку

     /Graph/Reset
          сброс установленных данных

     /Graph/Shape/
          переход в меню установки типа графика

     /Graph/Shape/Bar
          установка типа графика - столбчатая гистограмма

     /Graph/Shape/Graph
          установка типа графика - линейный график

     /Graph/Shape/Pie
          установка типа графика - круговая диаграмма

     /Graph/Shape/Stackedbar
          установка типа графика - совмещенная гистограмма

     /Graph/Shape/X-y
          установка типа графика - линейный график с нелинейной
          осью аргумента

     /Graph/axisA
          установка данных для оси аргумента (область от помечен-
          ной клетки до текущей)

     /Graph/axisB
          установка данных 1-й функции

     /Graph/axisC
          установка данных 2-й функции

     /Graph/axisD
          установка данных 3-й функции

     /Jump/
          переход в меню передвижения по таблице

     /Jump/Cell
          перейти на ячейку по имени



Printed 3/4/91                                                  7






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     /Jump/Down
          перейти к последней клетке в текущем столбце

     /Jump/End
          перейти к последней клетке таблицы

     /Jump/Left
          перейти к первой ячейке в текущей строке

     /Jump/Right
          перейти к последней ячейке в текущей строке

     /Jump/Up
          перейти к первой ячейке в текущем столбце

     /Quit
          выход из ШШЭЭТТ

     /Row/
          переход в меню работы со строками

     /Row/Copy
          дублирование текущей строки

     /Row/Delete
          удаление текущей строки

     /Row/Format/
          переход в меню установки формата

     /Row/Format/Center
          центрирование клеток в строке

     /Row/Format/Default
          установка формата по умолчанию

     /Row/Format/Leftalign
          установка прижима влево

     /Row/Format/Mark
          установка метки на текущую клетку

     /Row/Format/Precision
          задание точности для клеток в строке

     /Row/Format/Rightalign
          установка прижима вправо

     /Row/Hide
          спрятать текущую строку

     /Row/Insert



Printed 3/4/91                                                  8






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



          вставка пустой строки

     /Row/Show
          открыть спрятанные строки

     /Row/Undelete
          вернуть удаленную строку

     /Row/Valuize
          заменить формулы в текущей строке значениями

     /Utility/
          переход в меню сервисных команд

     /Utility/Width
          установка количества столбцов в таблице

     /Utility/Height
          установка количества строк в таблице

     /Utility/Minimize
          уменьшение таблицы до минимально возможных размеров

     /Utility/Recalc
          перевычисление таблицы

     /Utility/Autocalc
          установка/снятие режима автоматического перевычисления

     /Utility/Border
          установка/снятие режима отрисовки границы окна таблицы

     /Utility/Language
          переключение языка команд/сообщений

     /Utility/Precision
          установка точности по умолчанию

     /cOlumn/
          переход в меню работы со строками

     /cOlumn/Copy
          дублирование текущего столбца

     /cOlumn/Delete
          удаление текущего столбца

     /cOlumn/Format/
          переход в меню установки формата

     /cOlumn/Format/Center
          центрирование клеток в столбце



Printed 3/4/91                                                  9






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     /cOlumn/Format/Default
          установка формата по умолчанию

     /cOlumn/Format/Leftalign
          установка прижима влево

     /cOlumn/Format/Mark
          установка метки на текущую клетку

     /cOlumn/Format/Precision
          задание точности для клеток в столбце

     /cOlumn/Format/Rightalign
          установка прижима вправо

     /cOlumn/Hide
          спрятать текущий столбец

     /cOlumn/Insert
          вставка пустого столбца

     /cOlumn/Show
          открыть спрятанные столбцы

     /cOlumn/Undelete
          вернуть удаленный столбец

     /cOlumn/Valuize
          заменить формулы в текущем столбце значениями

     /cOlumn/Width
          установка ширины текущего столбца

     Синтаксис формульных выражений близок к математической
     записи.  Приоритет операций следующий (от высшего к низ-
     шему):
               $ ++  --  **  // -   !   ~   ' ^ *   / +   - <   =
               >   <=  >= & | ?

     e + e     сложение

     e - e     вычитание

     e * e     умножение

     e / e     деление

     e ^ e     возведение в степень

     -e        унарный минус

     e'        возведение в квадрат



Printed 3/4/91                                                 10






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     ~e        квадратный корень

     v ++ v    сумма всех непустых клеток в области с указанными
               углами

     v -- v    среднее всех непустых клеток в области с указан-
               ными углами

     v ** v    произведение всех непустых клеток в области с ука-
               занными углами

     v // v    количество непустых клеток в области

     e ? e : e условная операция: если первое выражение - не 0,
               то значением операции является значение второго
               выражения, иначе - значение третьего выражения

     <, =, >, <=, >=
               условные операции: 1 если выражение истинно, иначе
               0

     &, |      логические связки

     !e        операция логического отрицания

     $v        защита ссылки от коррекции при перемещении выраже-
               ния

     В выражениях можно использовать разнообразные математические
     функции.  Большей частью это стандартные библиотечные функ-
     ции, более полно описанные в _m_a_t_h(_3). Все они оперируют с
     плавающими числами двойной точности, тригонометрические
     функции работают с углами, выраженными в радианах.

     exp (expr)
               возвращает значение e в степени expr

     ln (expr) возвращает натуральный логарифм expr

     log (expr)
               возвращает десятичный логарифм expr

     pow (expr1, expr2)
               возвращает expr1 в степени expr2

     floor (expr)
               возвращает максимальное целое, не превосходящее
               expr

     ceil (expr)
               возвращает минимальное целое, не меньшее expr




Printed 3/4/91                                                 11






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     hypot (x, y)
               возвращает ~(x' + y'), предпринимая меры против
               переполнения

     fabs (expr)
               возвращает абсолютное значение |expr|

     sin (expr), cos (expr), tan (expr)
               возвращает тригонометрическую функцию аргумента

     asin (expr)
               возвращает arcsin в диапазоне -pi/2...pi/2

     acos (expr)
               возвращает arccos в диапазоне 0...pi

     atan (expr)
               возвращает arctg в диапазоне -pi/2...pi/2

     dtr (expr)
               преобразует expr из градусов в радианы

     rtd (expr)
               преобразует expr из радианов в градусы

     pi        примерно 3.1415926535...

     e         примерно 2.718281828459...

     max (expr1, expr2)
               возвращает наибольшее из двух значений, допуска-
               ется произвольное количество параметров

     min (expr1, expr2)
               возвращает наименьшее из двух значений, допуска-
               ется произвольное количество параметров

     gamma (expr1)
               возвращает натуральный логарифм гамма-функции

     Работой ШЭТ можно управлять с помощью глобальных переменных:

     TERM      имя терминала, служащее ключом поиска в базе дан-
               ных tteerrmmccaapp

     TERMCAP   альтернативное имя базы данных tteerrmmccaapp или строка
               описания терминала

     MSG       язык сообщений: r - русский, иначе - английский

     При работе в ОС, совместимых с UNIX, ШШЭЭТТ использует характе-
     ристики терминала из tteerrmmccaapp.. Обязательными являются



Printed 3/4/91                                                 12






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     следующие:

     li   количество строк на экране терминала (не меньше 7)

     co   количество символов в строке (не меньше 31)

     cm   позиционирование курсора

     Необязательные характеристики:

     is, fs
          инициализация, деинициализация терминала

     if   файл инициализации

     ti, te
          включение, выключение возможности позиционирования кур-
          сора

     vs, ve
          включение, выключение возможности выделения текста

     so, se
          включение, выключение выделения текста (инверсия)

     md, mh, me
          включение повышенного, пониженного, нормального уровня
          яркости

     ms   разрешение перемещения курсора в режиме выделения

     cl   стирание экрана и установка курсора в левый верхний
          угол

     al, dl
          вставка, удаление строки

     kl, kr, ku, kd
          коды клавиш управления курсором "влево", "вправо",
          "вверх", "вниз" соответственно

     kh, kN, kP
          коды клавиш "начало экрана", "следующая страница",
          "предыдущая страница"

     C1, C2, Nf, Nb, Mf, Mb, Cf, Cb
          параметры управления цветом (см. termcap(5) ДЕМОС 2.1)

ФФААЙЙЛЛЫЫ
     *.sc                файлы с таблицами

     workfile.sc         файл с таблицей по умолчанию



Printed 3/4/91                                                 13






ШЭТ(1)              UNIX Programmer's Manual               ШЭТ(1)



     /etc/termcap        файл с описаниями терминалов (кроме
                         MSDOS)

     /usr/lib/sc.????    файлы, со справочной информацией и сооб-
                         щениями (только для PC XT/VENIX,
                         Электроника-85/ДЕМОС, СМ-4/ДЕМОС)

ССССЫЫЛЛККИИ
     bc(1), dc(1), tbl(1), math(3), termcap(5), environ(7)














































Printed 3/4/91                                                 14



