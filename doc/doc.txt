i. Введение.
------------

В свое время появление настольных калькуляторов,
соединивших в себе точность компьютеров и портативность
логарифмической линейки, сильно изменило технику вычислений.
Персональные компьютеры, все настойчивее проникающие в нашу жизнь,
несут с собой очередную революцию.
Электронные таблицы, сочетающие вычислительную мощность и огромную память
компьютера с простотой и гибкостью калькулятора,
призваны в корне изменить представления о том, что и как
можно вычислять.

Чтобы работать с электронной таблицей, не нужно быть программистом,
достаточно иметь некоторый навык работы с клавиатурой компьютера.
Работая с электронной таблицей, необязательно знать ее
досконально, достаточно знать лишь несколько простых команд.

Основные черты электронных таблиц:
- большая память и скорость вычислений
- простота и дружественность в общении с пользователем
- наличие средств поддержки различных предметных областей
- наличие средств отображения данных в виде графиков
- поддержка создания простых баз данных
Все это делает электронные таблицы незаменимым инструментом
для экономических, статистических, деловых, инженерных
и научных приложений.

ii. Что такое электронная таблица.
----------------------------------

Электронная таблица - это инструмент, который делает
компьютер таким же простым в обращении, как и калькулятор,
но с гораздо более широкими возможностями.

Основа электронной таблицы - экран дисплея, разделенный на строки и столбцы.
Строки и столбцы, обозначаются цифрами и буквами.
Ширина столбцов может изменяться. Пересечения строк и столбцов образуют
ячейки. Каждая ячейка, подобно клетке шахматной доски, имеет имя,
составленное из номеров стодбца и строки, например, A1, BC10, и т. п.

Ячейки редназначены для трех основнах целей:
- хранения текста
- кранения чисел
- хранения формул, с помощью которых по данным из
одних ячеек таблицы вычисляются значения, подставляемые
в другие ячейки.

Наиболее важное свойство электронной таблицы - способность
мгновенно по формулам значения всех ячеек при изменении
ячеек, содержащих исходные данные.

iii. Краткие сведения о ШЭТ-3.0.
--------------------------------

ШЭТ-3.0 (широкоформатная электронная таблица, версия 3, вариант 0,
дальше - ШЭТ) - электронная таблица, разработанная в кооперативе ДЕМОС
для UNIX-совместимых операционных систем.

Основные возможности ШЭТ:
1. Размер таблицы - до 8192 строк и 702 столбцов (фактически
размер ограничен количеством доступной памяти).
2. Большой набор математических и логических операций и функций.
3. Система команд в виде меню.
4. Режим редактирования содержимого ячеек.
5. Набор команд копирования, вставки, удаления ячеек, строк, столбцов,
диапазонов клеток.
6. Работа на английском и русском языках.
7. Режим школы.
8. Возможность построения графиков, гистограмм, диаграмм по
имеющимся данным.
9. Возможность печати графиков на печатающем устройстве.
10. Возможность выдачи таблицы в виде, пригодном для использования
форматором текстов.
11. Неограниченный уровень зависимости ячеек.
12. Автоматическое обнаружение циклических зависимостей.

ШЭТ 3.0 умеет "общаться" с пользователем на двух языках -
английском и русском. Причем язык диагностических сообщений
и язык команд устанавливаются независимо.
В данном руководстве при описании возможностей ШЭТ
предполагается, что установлен режим русских сообщений и английских команд.

iv. Как читать эту книгу.
-------------------------

v. Обозначения клавиш.
----------------------

При описании команд в тексте используются обозначения клавиш, которые
могут отличаться от обозначених на клавиатурах конкретных терминалов.
Ниже приведен список эквивалентных обозначений.

	В тексте                На клавиатуре

	<Return>                <Ret>, <Enter>, <ВК>, <ПС>, ^J, ^M
	<Ctrl>                  <Упр>
	<Tab>                   <ГТ>, ^I
	<Esc>                   <АР2>, ^[
	<Backspace>             <ВШ>, ^H
	<Delete>                <ЗБ>
	<PgUp>                  <Prev Page>, <Пред. Страница>
	<PgDn>                  <Next Page>, <След. Страница>
	<Home>                  <Начало>
	<End>                   <Конец>
	<влево>                 стрелка влево
	<вправо>                стрелка вправо
	<вверх>                 стрелка вверх
	<вниз>                  стрелка вниз

Команды, обозначаемае как ^X, где X - произволиные символ,
вводятся одновремнным нажатием двух главиш, <Ctrl> n X.

На отдельных терминалах некоторые из указанных клавиш могут
отсутствовать. Их можно заменить управляющими символами согласно
следующей таблице:

	<Return>                ^J, ^M
	<Tab>                   ^I
	<Esc>                   ^[
	<Backspace>             ^H
	<PgUp>                  ^K
	<PgDn>                  ^B
	<Home>                  ^Y
	<End>                   ^Z
	<влево>                 ^L
	<вправо>                ^R
	<вверх>                 ^U
	<вниз>                  ^D

vi. Обозначения команд.
-----------------------

Система команд ШЭТ имеет иерархическую структуру.
Команды собраны в дерево, в узлах которого находятся меню.
Полное имя команды состоит из имен ведущих к нему меню,
разделенных символом '/', и, собственно, имени команды.
Например:

	/File/Save
	/Cell/Format/Precision

Каждая команда имеет два равноправных названия, русское и английское.
Поскольку не все терминалы имеют русские буквы, а на некоторых
ввод русских букв затруднен, мы в описании используем английскую мнемонику.
Полный список русских и английских названий команд приведен в приложении.

1. Вызов ШЭТ.
-------------

Простейший способ вызова ШЭТ выглядит следующим образом:
- войти в систему
- на приглашение системы набрать

	sc

- нажать <Return>.

Появится сообщение

	Минуточку...

и затем вы получите на экране изображение таблицы.
Фактически при вызове без параметров ШЭТ пытается считать таблицу
из файла "workfile.sc". Если его нет, таблица оказывается пустой.
О роли файла "workfile.sc" будет рассказано в следующей главе.

1.1. Вызов с аргументом.
------------------------

Если у вас уже есть файл с таблицей, полученный после предыдущих сеансов
работы в ШЭТ, и вы хотите продолжить работу с нею, вы можете вызвать
ШЭТ, указав имя файла в качестве параметра:

	sc filename

При записи в файл и чтении из файла ШЭТ добавляет к имени суффикс ".sc".
Если такого файла нет, то при вызове ШЭТ сообщит вам об этом.

1.2. Файл "workfile.sc".
------------------------

Существует одно "особенное" имя файла - "workfile.sc".
Этот файл играет роль рабочего, или "файла по уполчанию".
При вызове без параметров считывается его содержимое,
при выходе, если не задано другое имя, ШЭТ сохраняет таблицу в этом файле.

Эта особенность оказывается полезной, если вы работаете только
с одной таблицей. В этом случае при вызове ШЭТ вы можете не указывать
имя файла, и работа будет вестись с файлом "workfile.sc".

1.3. Ключи.
-----------

В командной строке вызова ШЭТ можно указывать ключи, управляющие работой
и режимами системы. Каждый ключ имеет вид символа '-' (минус),
за которым может следовать буква и целочисленный параметр.
Ниже приведены описания всех ключей:

	-       Не считывать файл "workfile.sc". Полезно, если вы
		хотите получить заведомо пустую таблицу.

	-a      Отключить режим автоматического перевычисления.
		Обычно ШЭТ при изменении одной из ячеек сразу же
		перевычисляет по формулам значения остальных.
		Если же формул очень много, и они достаточно сложные,
		это может отнимать слишком много времени.
		Данный ключ переводит ШЭТ в "ручной" режим,
		когда перевычисление происходит по команде
		пользователя /Utility/Recalc.
		Режим перевычисления можно также менять командой
		/Utility/Autocalc.

	-b      Отключить отображение границ окна, подсказки и строки
		состояния. Это полезно при работе в ШЭТ с терминалов,
		имеющих малую скорость обмена (меньше 1200 бод).
		При этом количество и время вывода информации на терминал
		снижаются. Этот режим также влияет на печать таблицы
		(команды /File/Print, /File/Tbl). Режим отображения
		границ окна можно менять командой /Utility/Border.

	-m      Не использовать цветовые возможности терминала,
		работать в черно-белом режиме. Это полезно для
		терминалов с жидкокристаллическим экраном.

	-l      Установить язык команд и сообщений.
		Смысл этого будет ясен в в следующей главе.
		Языковый режим можно также
		изменять командой /Utility/Language

	-r#     Здесь # - целое число в диапазоне от 1 до 8192.
		Этот ключ устанавливает максимальное количество строк,
		которое может иметь таблица. По умолчанию эта
		величина равна 64.

	-c#     Здесь # - целое число от 1 до 702. Этот ключ устанавливает
		максимальный размер таблицы в столбцах.
		По умолчанию - 16.

		При заполнении таблицы ее размеры корректируются
		автоматически, так что к указанным возможностям
		приходится прибегать редко.

		Размеры таблицы можно также изменять командами
		/Utility/Width, /Utility/Height, /Utility/Minimize.

1.4. Выбор языкового режима.
----------------------------

В ШЭТ есть три языковых режима команд и сообщений:

1) Английские команды, русские сообщения.
Это - единственный приемлемый режим для терминалов без русских букв.

2) Английские команды, русские сообщения.
Самый удобный режим для терминалов, у которых ввод русских букв затруднен.

3) Русские команды, русские сообщения.
Режим для руссифицированных терминалов.

Языковым режимом можно управлять посредством ключа '-l' и
глобальной переменной MSG.

1.5. Глобальные переменные.
---------------------------

ШЭТ использует значения некоторых глобальных переменных для управления
внутренними режимами и работой с терминалом. Описания этих переменных
приведены ниже:

TERMCAP         Это необязательная переменная. Она определяет имя
		базы данных терминалов (в этом случае ее значение
		должно начинаться с символа '/') или собственно
		описание конкретного терминала. Если переменная не
		установлена, используется имя '/etc/termcap'.
		Значение этой переменной обычно устанавливается
		системой и нет необходимости его изменять.

TERM            Эта переменная содержит имя терминала, по которому
		ШЭТ определяет из базы данных termcap его характеристики.
		Полный список используемых характеристик терминала
		приведен в приложении.

MSG             Эта переменная определяет языковый режим ШЭТ.
		Если MSG=r, то устанавливается 2-й режим,
		иначе - 1-й. Можно изменять языковый режим
		командой /Utility/Language, а также ключом '-l'.

2. Что изображено на экране.
----------------------------

При работе в ШЭТ экран имеет следующий вид:

размер p63, конец a0, метка a0, занято 13452, свободно 9914423, авто
     ||    a   ||    b   ||    c   ||    d   ||    e   ||    f   ||    g   |
    0|
    1|
    2|
    3|
    4|          [        ]
    5|
    6|
    7|
    8|
    9|
   10|
   11|
   12|
   13|
   14|
   15|
   16|
   17|
   18|
b4 (10.0) пусто
1/
File/ Cell/ Row/ cOlumn/ Area/ Jump/ Graph/ Utility/ Quit
^Pшкола ^Cотказ ^Xэкран ^Gграфик

2.1. Таблица.
-------------

Основную часть экрана занимает окно, в котором изображена часть рабочей
таблицы. Строки и столбцы пронумерованы по левой и верхней границам окна.

Одна из клеток окна выделена. Она называется текущей, или табличным курсором.

Кроме таблицы, на экране отображается также некоторая дополнительная
информация.

В верхней части экрана, над таблицей, находится строка состояния.
Ниже таблицы расположены строка статуса текущей клетки, строка ввода,
меню и подсказка.

2.2. Меню.
----------

Строка меню содержит список команд, которые можно выполнить на
данном уровне меню. В названии каждой команды одна из букв выделена.
Чтобы выбрать команду, нужно нажать эту букву.

Если после имени команды стоит символ '/', значит, при выполнении
этой команды происходит переход к новому меню.

Например, в меню /Cell/:

	Mark Copy Delete Undelete Format/

вы можете выполнять команды, нажимая соответствующие буквы:

	Команда         Буква           Измемение меню

	Mark            m               -
	Copy            c               -
	Delete          d               -
	Undelete        u               -
	Format          f               +

2.3. Подсказка.
---------------

Подсказка, находящаяся в нижней строке экрана, содержит список
управляющих команд, которые доступны для выполнения в дынном режиме и не
зависят от состояния меню.

Ниже приведены таблицы команд подсказки для режимов команд,
ввода и редактора. Смысл режимов и команд будет описан в последующих главах.

Режим команд:

	Команда         Команда         Упр.    Действия
	рус             лат             символ

	Школа           Help            ^P      Выдача краткой справки
	Отказ           Cancel          ^C      Отказ от выполнения команды
	Экран           Clear           ^X      Перерисовка экрана
	График          Graph           ^G      Построение графика

Режим ввода:

	Команда         Команда         Упр.    Действия
	рус             лат             символ

	Школа           Help            ^P      Выдача краткой справки
	Отказ           Cancel          ^C      Отказ от выполнения команды
	Экран           Clear           ^X      Перерисовка экрана
	График          Graph           ^G      Построение графика
	Имя             Name            ^A      Ввод имени текущей клетки
	Формула         Formula         ^F      Ввод формулы из текущей клетки
	Число           Value           ^V      Ввод числа из текущей клетки
	Текст           Text            ^T      Ввод текста из текущей клетки
	Редактор        Edit            ^E      Переход в режим редактора

Режим редактора:

	Команда         Команда         Упр.    Действия
	рус             лат             символ

	Влево           Left            ^L      Движение влево по строке
	Вправо          Right           ^R      Движение вправо по строке
	Уничт           Delete          ^D      Удаление символа
	Вст             Undelete        ^U      Вставка удаленного символа
	Экран           Clear           ^X      Перерисовка экрана
	Отказ           Cancel          ^C      Отказ от введенной строки
	Backspace       Backspace       ^H      Удаление предыдущего символа
	Tab             Tab             ^I      Переход в конец/начало строки
	Return          Return          ^M      Возврат в режим ввода

2.4. Статус текущей клетки.
---------------------------

Каждая клетка таблицы имеет достаточно много атрибутов. Это, прежде всего,
ее содержимое - число, текст или формула, а также формат и точность
представления числа, тип выравнивания, ширина.
Вся эта информация подробно отображается в строке статуса текущей клетки.
